<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Audit Configuration Tree View -->
        <record id="audit_config_tree" model="ir.ui.view">
            <field name="name">audit.config.tree</field>
            <field name="model">audit.config</field>
            <field name="arch" type="xml">
                <tree string="Audit Configurations">
                    <field name="name"/>
                    <field name="active" widget="boolean_toggle"/>
                    <field name="enable_auditing" widget="boolean_toggle"/>
                    <field name="log_read" widget="boolean_toggle"/>
                    <field name="log_write" widget="boolean_toggle"/>
                    <field name="log_create" widget="boolean_toggle"/>
                    <field name="log_unlink" widget="boolean_toggle"/>
                    <field name="all_users" widget="boolean_toggle"/>
                    <field name="all_objects" widget="boolean_toggle"/>
                </tree>
            </field>
        </record>

        <!-- Audit Configuration Form View -->
        <record id="audit_config_form" model="ir.ui.view">
            <field name="name">audit.config.form</field>
            <field name="model">audit.config</field>
            <field name="arch" type="xml">
                <form string="Audit Configuration">
                    <header>
                        <button name="%(action_audit_clear_wizard)d" string="Clear Logs" 
                                type="action" class="btn-primary" 
                                groups="peepl_audit_session.group_audit_manager"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" placeholder="Configuration Name"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="active"/>
                                <field name="enable_auditing" widget="boolean_toggle"/>
                                <field name="auto_cleanup_days"/>
                                <field name="session_timeout_hours"/>
                            </group>
                        </group>
                        
                        <div class="alert alert-warning" role="alert" attrs="{'invisible': [('enable_auditing', '=', True)]}">
                            <strong>Warning:</strong> Auditing is currently disabled. No activity logs will be recorded.
                        </div>
                        
                        <notebook>
                            <page string="Operations to Log">
                                <group>
                                    <group string="CRUD Operations">
                                        <field name="log_create"/>
                                        <field name="log_write"/>
                                        <field name="log_read"/>
                                        <field name="log_unlink"/>
                                    </group>
                                </group>
                            </page>
                            
                            <page string="Users to Audit">
                                <group>
                                    <field name="all_users"/>
                                </group>
                                <field name="user_ids" attrs="{'invisible': [('all_users', '=', True)]}">
                                    <tree editable="bottom">
                                        <field name="user_id"/>
                                    </tree>
                                </field>
                            </page>
                            
                            <page string="Models to Audit">
                                <group>
                                    <field name="all_objects"/>
                                </group>
                                <field name="object_ids" attrs="{'invisible': [('all_objects', '=', True)]}">
                                    <tree editable="bottom">
                                        <field name="model_id"/>
                                        <field name="model_name"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Audit Configuration Search View -->
        <record id="audit_config_search" model="ir.ui.view">
            <field name="name">audit.config.search</field>
            <field name="model">audit.config</field>
            <field name="arch" type="xml">
                <search string="Audit Configurations">
                    <field name="name"/>
                    <filter string="Active" name="active" domain="[('active', '=', True)]"/>
                    <filter string="Inactive" name="inactive" domain="[('active', '=', False)]"/>
                    <separator/>
                    <filter string="Log Create" name="log_create" domain="[('log_create', '=', True)]"/>
                    <filter string="Log Write" name="log_write" domain="[('log_write', '=', True)]"/>
                    <filter string="Log Read" name="log_read" domain="[('log_read', '=', True)]"/>
                    <filter string="Log Delete" name="log_unlink" domain="[('log_unlink', '=', True)]"/>
                    <group expand="0" string="Group By">
                        <filter string="Status" name="group_by_active" context="{'group_by': 'active'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Audit Configuration Action -->
        <record id="action_audit_config" model="ir.actions.act_window">
            <field name="name">Audit Configurations</field>
            <field name="res_model">audit.config</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_active': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create your first audit configuration!
                </p>
                <p>
                    Configure which users, models, and operations to audit.
                    You can have multiple configurations but only one can be active at a time.
                </p>
            </field>
        </record>

        <!-- Audit Configuration User Tree View -->
        <record id="audit_config_user_tree" model="ir.ui.view">
            <field name="name">audit.config.user.tree</field>
            <field name="model">audit.config.user</field>
            <field name="arch" type="xml">
                <tree string="Audit Configuration Users" editable="bottom">
                    <field name="config_id"/>
                    <field name="user_id"/>
                </tree>
            </field>
        </record>

        <!-- Audit Configuration Object Tree View -->
        <record id="audit_config_object_tree" model="ir.ui.view">
            <field name="name">audit.config.object.tree</field>
            <field name="model">audit.config.object</field>
            <field name="arch" type="xml">
                <tree string="Audit Configuration Objects" editable="bottom">
                    <field name="config_id"/>
                    <field name="model_id"/>
                    <field name="model_name"/>
                </tree>
            </field>
        </record>

    </data>
</odoo>